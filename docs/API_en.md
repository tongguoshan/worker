# API Documentation

## Start Lag[i] (Landing AGI)

### 1.Configure yml files

Modify [`src/main/resources/lagi.yml`](../lagi-web/src/main/resources/lagi.yml) configuration file, select the model you like, will be one of the major language model your - API - key information such as the replacement for your own key, And set the 'enable' field of the enabled model to 'true' as needed. See the [configuration documentation](config_en.md) for details.

***Take kimi：***

Fill in the model information and enable the model, changing enable to true.

```yaml
  - name: kimi
    type: Moonshot
    enable: true
    model: moonshot-v1-8k,moonshot-v1-32k,moonshot-v1-128k
    driver: ai.llm.adapter.impl.MoonshotAdapter
    api_key: your-api-key 
```

Depending on your needs, set the mode stream and the priority of the model output, the higher the priority.

```yaml
  chat:
    - backend: doubao
      model: doubao-pro-4k
      enable: true
      stream: true
      priority: 160

    - backend: kimi
      model: moonshot-v1-8k
      enable: true
      stream: true
      priority: 150
```

### 2.import dependencies

To call the lag[i] (Landing AGI) API, you need to import the dependencies, which you can import via maven or directly by importing the jar.

***Take maven：***

Use maven to download the dependency execution command.

```shell
mvn clean install
```

### 3.Starting the web service

You can choose to use the maven command-line tool for wrapping, or run it through a popular integrated development environment (IDE) such as IntelliJ IDEA. Make sure your JDK version meets at least 8.

***Take maven packaging：***

Use the maven command to wrap the project, which will generate a war file in the 'target' directory.

```shell
mvn package
```

Deploy the generated war package to the Tomcat server. After starting Tomcat, you can view the Lag[i] (Landing AGI) page by visiting the corresponding port in your browser.

## Completions Interface

POST `/chat/completions`

Enter a prompt to get an answer from the large model.

### Body request parameters

```json
{
  "model": "gpt-3.5-turbo-1106",
  "temperature": 0.8,
  "max_tokens": 500,
  "category": "xxxx",
  "messages": [
    {
      "role": "user",
      "content": "Check the number of units that have moved to the cloud in the big data center."
    }
  ]
}
```

### Request Parameters

| Name          | Position | Type     | Required | Description                                                                                                                                                                                                                                                                           |
| ------------- | -------- | -------- | -------- |---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| body          | body     | object   | No       | none                                                                                                                                                                                                                                                                                  |
| » model       | body     | string   | No       | Model type                                                                                                                                                                                                                                                                            |
| » temperature | body     | number   | Yes      | The parameter used to control the creativity and diversity of text generated by language models, ranging between 0 and 1. Lowering the temperature makes the model generate more certain and high-probability text, while increasing it enhances the text's randomness and diversity. |
| » max_tokens  | body     | integer  | Yes      | The maximum number of tokens that can be generated.                                                                                                                                                                                                                                   |
| » category    | body     | string   | No       | Data category                                                                                                                                                                                                                                                                         |
| » messages    | body     | [object] | Yes      | List of submitted messages                                                                                                                                                                                                                                                            |
| »» role       | body     | string   | No       | user or assistant, user indicates user submission, assistant indicates model output                                                                                                                                                                                                   |
| »» content    | body     | string   | No       | If the role is user, then context is the content entered by the user. If the role is assistant, then context is the output content of the large model.                                                                                                                                |

### Return example

> Success

```json
{
  "id": "chatcmpl-W9Hp9zbUjE572UKvPZvybz",
  "object": "chat.completion",
  "created": 1709287530,
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "Knowledge graphs are a structured way to represent and organize human knowledge. They present knowledge points (i.e., facts, concepts, relationships, etc.) and their interconnections in a graphical manner, enabling better understanding and use of this knowledge by humans or machines. Knowledge graphs can help people better explore and understand knowledge in a specific domain and quickly find the information they need when necessary. In the context of this document, knowledge graphs are used to consolidate and store expert knowledge to support business decisions and transform into profit centers."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 0,
    "completion_tokens": 0,
    "total_tokens": 0
  }
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name                 | Type     | Required | Description                                                                         |
|----------------------| -------- |----------|-------------------------------------------------------------------------------------|
| » id                 | string   | true     | Unique identifier                                                                   |
| » object             | string   | true     | Object type                                                                         |
| » created            | integer  | true     | Unix timestamp (seconds) when the chat was created                                  |
| » choices            | [object] | true     | List of choices                                                                     |
| »» index             | integer  | false    | Index of the object                                                                 |
| »» message           | object   | false    | Returned message                                                                    |
| »»» role             | string   | true     | user or assistant, user indicates user submission, assistant indicates model output |
| »»» content          | string   | true     | The output of the large model.                                                      |
| »»» context          | string   | false     | Context information from the vector database                                        |
| »» finish_reason     | string   | false    | Reason for model stop generating                                                    |
| » usage              | object   | true     | Usage statistics for the request                                                    |
| »» prompt_tokens     | integer  | true     | Number of tokens in the prompt.                                                     |
| »» completion_tokens | integer  | true     | Number of generated tokens                                                          |
| »» total_tokens      | integer  | true     | Total number of tokens used in the request                                          |

## Speech Recognition

POST `/audio/speech2text`

The speech recognition interface returns the text after recognition.

### Body request parameters

The request body passes binary audio data, so the `Content-Type` in the HTTPS request header must be set to `application/octet-stream`.

### Request Parameters

| Name         | Position | Type           | Required | Description |
| ------------ | -------- | -------------- | -------- | ----------- |
| Content-Type | header   | string         | No       | none        |
| body         | body     | string(binary) | No       | none        |

### Return example

> Success

```json
{
  "result": "What are you going to do if this situation occurs",
  "status": 20000000
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name     | Type    | Required | Description                |
| -------- | ------- | -------- | -------------------------- |
| » result | string  | true     | Speech recognition result. |
| » status | integer | true     | Service status code.       |

## Text-to-Speech

GET /audio/text2speech

Enter text to return a spoken audio file.

### Request Parameters

| Name | Position | Type   | Required | Description            |
| ---- | -------- | ------ | -------- | ---------------------- |
| text | query    | string | Yes      | Text to be synthesized |

### Response Result

- Successful response
  - The content of the `Content-Type` field in HTTPS Headers is `audio/mpeg`, indicating successful synthesis, with the synthesized audio data in the response body.
  - The response content is binary data of the synthesized audio.
- Failure response
  - No `Content-Type` field in HTTP Headers, or the content of the `Content-Type` field is `application/json`, indicating failure of synthesis, with error information in the response body.

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

## Image Generation

POST `/image/text2image`

Enter a command to generate images and return images.

### Body request parameters

```json
{
  "prompt": "a.pig"
}
```

### Request Parameters

| Name     | Position | Type   | Required | Description                |
| -------- | -------- | ------ | -------- | -------------------------- |
| body     | body     | object | No       | none                       |
| » prompt | body     | string | Yes      | Command to generate images |

### Return example

> Success

```json
{
  "created": 1709288374,
  "data": [
    {
      "url": "http://116.255.226.214:9000/stable-diffusion/tlnniooq240301181913.png?response-content-type=image%2F%2A&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=9OMV1OGIpDH29iDq1HWC%2F20240301%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20240301T101913Z&X-Amz-Expires=7200&X-Amz-SignedHeaders=host&X-Amz-Signature=6670b8278a61aa8953e424da4c77386c120821ab5bf49ee31970b027a88430ae"
    }
  ]
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name      | Type     | Required | Description                                        |
| --------- | -------- | -------- | -------------------------------------------------- |
| » created | integer  | true     | Unix timestamp (seconds) when the chat was created |
| » data    | [object] | true     | Generated image data                               |
| »» url    | string   | false    | Generated image address                            |

## Upload Private Training Files

POST `/training/upload`

Upload private training files, supporting txt, word, pdf formats.

### Body request parameters

```yaml
fileToUpload: file://D:/KnowledgeGraph.pdf
```

### Request Parameters

| Name           | Position | Type           | Required | Description                              |
| -------------- | -------- | -------------- | -------- | ---------------------------------------- |
| category       | query    | string         | Yes      | Specified data category                  |
| body           | body     | object         | No       | none                                     |
| » fileToUpload | body     | string(binary) | Yes      | The private training file being uploaded |

### Return example

> Success

```json
{
  "result": true
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name     | Type    | Required | Description                |
|----------|---------|----------|----------------------------|
| » result | boolean | true     | Status of uploading private training file |

## Training Private Q&A Pair Data

POST `/training/pairing`

Training private Q&A pair data, required in JSON format

### Body request parameters

The data and instruction field supports either an object or a list of objects, as shown in the request examples below.

```json
{
    "category": "default",
    "data": {
        "instruction": "What are the steps involved in reissuing a medical practitioner's license?",
        "output": "The process of reissuing a medical practitioner's license includes five steps: application/receipt, acceptance, decision, certification, and issuance.",
        "image":"[{\"path\": \"https://downloads.saasai.top/vector/szu/8EB8BC9D3E5F4D987BBDB93ECEB_58E46C1C_6DCB0.png\"}]"
    }
}
```

```json
{
    "category": "default",
    "data": [
        {
            "instruction": "What are the steps involved in reissuing a medical practitioner's license?",
            "output": "The process of reissuing a medical practitioner's license includes five steps: application/receipt, acceptance, decision, certification, and issuance."
        },
        {
            "instruction": "What are the stages in the process of reissuing a medical practitioner's license?",
            "output": "The process of reissuing a medical practitioner's license includes five steps: application/receipt, acceptance, decision, certification, and issuance.",
            "image":"[{\"path\": \"https://downloads.saasai.top/vector/szu/8EB8BC9D3E5F4D987BBDB93ECEB_58E46C1C_6DCB0.png\"}]"
        }
    ]
}
```

```json
{
    "category": "default",
    "data": [
        {
            "instruction": [
                "What are the steps involved in reissuing a medical practitioner's license?",
                "What are the stages in the process of reissuing a medical practitioner's license?"
            ],
            "output": "The process of reissuing a medical practitioner's license includes five steps: application/receipt, acceptance, decision, certification, and issuance."
            "image":"[{\"path\": \"https://downloads.saasai.top/vector/szu/8EB8BC9D3E5F4D987BBDB93ECEB_58E46C1C_6DCB0.png\"}]"
        }
    ]
}
```

### Request Parameters

| Name           | Position | Type               | Required | Description                               |
|----------------|----------| ------------------ |---------|-------------------------------------------|
| body           | body     | object             | No      | none                                      |
| » category     | body     | string             | Yes     | Specified data category                   |
| » data         | body     | [object] or object | Yes     | Q&A pair data                             |
| »» instruction | body     | [object] or object | Yes     | Question string or collection             |
| »» output      | body     | [object] or object | Yes     | Answer string or collection               |
| »» image       | body     | [object] or object | No      | A collection of related picture objects   |

### Return example

> Success

```json
{
  "status": "success"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name     | Type   | Required | Description       |
| -------- | ------ | -------- | ----------------- |
| » result | string | true     | Status of QA data |

## Image Captioning

POST `/image/image2text`

Upload an image and return a description of the image.

### Body request parameters

```yaml
file: file://D:\Test\Datasets\Image\kppziguz230716233346.jpg
```

### Request Parameters

| Name   | Position | Type           | Required | Description                   |
| ------ | -------- | -------------- | -------- | ----------------------------- |
| body   | body     | object         | No       | none                          |
| » file | body     | string(binary) | Yes      | The image file being uploaded |

### Return example

> Success

```json
{
  "classification": "Forklift Fuel Pump ",
  "caption": "A bunch of bicycles parked on the street side",
  "samUrl": "http://116.255.226.214:9000/sam/qlztvdkv240301172715.png?response-content-type=image%2F%2A&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=9OMV1OGIpDH29iDq1HWC%2F20240301%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20240301T092715Z&X-Amz-Expires=7200&X-Amz-SignedHeaders=host&X-Amz-Signature=0199b49a10eb6a18f01c4cec8e10549642ee6953c0f00c308bfc644e55d86c66",
  "status": "success"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name             | Type   | Required | Description                          |
| ---------------- | ------ | -------- | ------------------------------------ |
| » status         | string | true     | Status of the image captioning call  |
| » classification | string | true     | Identified categories of the image   |
| » caption        | string | true     | Recognized description of the image  |
| » samUrl         | string | true     | Uploaded image's segmentation result |

## Video Tracking

POST `/video/video2tracking`

Upload a video for video tracking.

### Body request parameters

```yaml
file: file://D:\Test\Datasets\Video\demo.mp4
```

### Request Parameters

| Name   | Position | Type           | Required | Description                   |
| ------ | -------- | -------------- | -------- | ----------------------------- |
| body   | body     | object         | No       | none                          |
| » file | body     | string(binary) | Yes      | The video file being uploaded |

### Return example

> Success

```json
{
  "data": "static/video/d01476eb-80de-4a7d-a5bb-566644c96a81.mp4",
  "status": "success"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name     | Type   | Required | Description                  |
| -------- | ------ | -------- | ---------------------------- |
| » status | string | true     | Status of the result         |
| » data   | string | true     | Address of the tracked video |

## Image Enhancement

POST `/image/image2enhance`

Upload an image to enhance a blurry image.

### Body request parameters

```yaml
file: file://D:\Test\Datasets\Image\kppziguz230716233346.jpg
```

### Request Parameters

| Name   | Position | Type           | Required | Description                   |
| ------ | -------- | -------------- | -------- | ----------------------------- |
| body   | body     | object         | No       | none                          |
| » file | body     | string(binary) | Yes      | The image file being uploaded |

### Return example

> Success

```json
{
  "status": "success",
  "enhanceImageUrl": "http://116.255.226.214:9000/realesrgan/tfukxzrq240301172914.png?response-content-type=image%2F%2A&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=9OMV1OGIpDH29iDq1HWC%2F20240301%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20240301T092921Z&X-Amz-Expires=7200&X-Amz-SignedHeaders=host&X-Amz-Signature=931b1c9d1b850095d58763db042bd982108dc0c2415985df37d6efa824f33fff"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name              | Type   | Required | Description                   |
| ----------------- | ------ | -------- | ----------------------------- |
| » enhanceImageUrl | string | true     | Address of the enhanced image |
| » status          | string | true     | Status of the result          |

## Picture to video

POST `/image/image2video`

Upload an image and generate a short video based on that image.

### Body request parameters

```yaml
file: file://D:\Test\Datasets\Image\kppziguz230716233346.jpg
```

### Request Parameters

| Name   | Position | Type           | Required | Description                   |
| ------ | -------- | -------------- | -------- | ----------------------------- |
| body   | body     | object         | No       | none                          |
| » file | body     | string(binary) | Yes      | The image file being uploaded |

### Return example

> Success

```json
{
  "svdVideoUrl": "static/img/svd/7ef10bdd-1c72-4091-a7aa-db651966f076.mp4",
  "status": "success"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name          | Type   | Required | Description                    |
| ------------- | ------ | -------- | ------------------------------ |
| » svdVideoUrl | string | true     | Address of the generated video |
| » status      | string | true     | Status of the result           |

## Video Enhancement

POST `/video/video2enhance`

Upload a video for video frame interpolation.

### Body request parameters

```yaml
file: file://D:\Test\Datasets\Video\demo.mp4
```

### Request Parameters

| Name   | Position | Type           | Required | Description                   |
| ------ | -------- | -------------- | -------- | ----------------------------- |
| body   | body     | object         | No       | none                          |
| » file | body     | string(binary) | Yes      | The video file being uploaded |

### Return example

> Success

```json
{
  "data": "static/video/d01476eb-80de-4a7d-a5bb-566644c96a81.mp4",
  "status": "success"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name     | Type   | Required | Description                   |
| -------- | ------ | -------- | ----------------------------- |
| » status | string | true     | Status of the result          |
| » data   | string | true     | Address of the enhanced video |

## Image to ocr

POST `/image/image2ocr`

Upload an image and recognize the text on that image.

### Body request parameters

```yaml
file: file://D:\Test\Datasets\Image\kppziguz230716233346.jpg
```

### Request Parameters

| Name   | Position | Type           | Required | Description            |
| ------ | -------- | -------------- | -------- |------------------------|
| body   | body     | object         | No       | none                   |
| » file | body     | string(binary) | Yes      | Uploading image files  |

### Return example

> Success

```json
{
  "data": ["The development of image-text recognition conversion technology has greatly improved the efficiency of information processing, making information more convenient for storage, retrieval and analysis."],
  "status": "success"
}
```

### Return Result

| Status Code | Meaning | Description |
| ----------- | ------- | ----------- |
| 200         | OK      | Success     |

### Return Data Structure

Status Code **200**

| Name     | Type            | Required | Description                              |
| -------- |-----------------| -------- |------------------------------------------|
| » status | string          | true     | Status of the result                     |
| » data   | List< string >  | true     | Returns an array of recognized literals  |
